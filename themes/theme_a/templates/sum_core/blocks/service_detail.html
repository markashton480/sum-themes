{% load wagtailcore_tags wagtailimages_tags %}

{% with has_image=self.image %}
<section class="bg-sage-black text-sage-linen py-24"{% if section_id %} data-section-id="{{ section_id }}"{% endif %}>
    <div class="max-w-7xl mx-auto px-6">
        {% if has_image and self.layout != "no_image" %}
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="space-y-6 {% if self.layout == 'image_right' %}lg:order-1{% else %}lg:order-2{% endif %}">
                    {% if self.eyebrow %}
                        <span class="block text-sage-moss font-bold uppercase tracking-widest text-xs">{{ self.eyebrow }}</span>
                    {% endif %}

                    <div class="font-display text-3xl md:text-4xl text-sage-linen leading-tight">
                        {{ self.heading|richtext }}
                    </div>

                    <div class="text-lg font-light text-sage-footer-primary">
                        {{ self.body|richtext }}
                    </div>

                    {% if self.highlights %}
                        <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {% for highlight in self.highlights %}
                                <li class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-sage-terra" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-base">{{ highlight }}</span>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                    {% if self.cta_text and self.cta_url %}
                        <div>
                            <a href="{{ self.cta_url.href }}" {{ self.cta_url.attrs_str }} class="inline-flex items-center text-xs font-bold uppercase tracking-widest border-b border-sage-moss/60 pb-2 hover:border-sage-terra hover:text-sage-terra transition-colors">
                                {{ self.cta_text }}
                                <svg class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                </svg>
                            </a>
                        </div>
                    {% endif %}
                </div>

                <div class="relative {% if self.layout == 'image_right' %}lg:order-2{% else %}lg:order-1{% endif %}">
                    <div class="aspect-[4/3] md:aspect-[5/4] overflow-hidden rounded-3xl shadow-xl bg-sage-black/20 border border-sage-moss/30">
                        {% image self.image fill-1200x900 class="w-full h-full object-cover" alt=self.alt_text|default:self.heading|striptags %}
                    </div>
                    <div class="absolute -left-6 -bottom-6 hidden lg:block w-32 h-32 bg-sage-terra/10 blur-3xl pointer-events-none"></div>
                </div>
            </div>
        {% else %}
            <div class="flex flex-col md:flex-row items-center gap-12">
                <div class="w-full md:w-1/3">
                    {% if self.eyebrow %}
                        <span class="block text-sage-moss font-bold uppercase tracking-widest text-xs mb-4">{{ self.eyebrow }}</span>
                    {% endif %}
                    <div class="font-display text-3xl md:text-4xl text-sage-linen mb-6">
                        {{ self.heading|richtext }}
                    </div>
                </div>
                <div class="w-full md:w-2/3 border-l border-sage-moss/30 pl-8 md:pl-12">
                    <div class="text-lg font-light text-sage-footer-primary mb-6">
                        {{ self.body|richtext }}
                    </div>
                    {% if self.highlights %}
                        <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {% for highlight in self.highlights %}
                                <li class="flex items-center gap-3">
                                    <svg class="w-5 h-5 text-sage-terra" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    <span class="text-base">{{ highlight }}</span>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if self.cta_text and self.cta_url %}
                        <div class="mt-6">
                            <a href="{{ self.cta_url.href }}" {{ self.cta_url.attrs_str }} class="inline-flex items-center text-xs font-bold uppercase tracking-widest border-b border-sage-moss/60 pb-2 hover:border-sage-terra hover:text-sage-terra transition-colors">
                                {{ self.cta_text }}
                                <svg class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                </svg>
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>
</section>
{% endwith %}
